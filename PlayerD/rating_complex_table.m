function [ Bewertung ] = rating_complex_table( Brett, Farbe )

    Table =     [200   -18  8  6  6  8  -18   200;...
                -18  -24 -4 -3 -3 -4  -24  -18;... 
                 8   -5  7  4  4  7  -5    8;...
                 6   -3  4  0  0  4  -3    6;... 
                 6   -3  4  0  0  4  -3    6;...
                 8   -5  7  4  4  7  -5    8;...
                -18  -24 -4 -3 -3 -4  -24  -18;... 
                200   -18  8  6  6  8  -18   200];

     
   if Brett(1,1)
       Table(1,2)=10;
       Table(2,1:2)=10; 
   end
   
   if Brett(1,8)
       Table(1,7)=10;
       Table(2,7:8)=10; 
   end
   
   if Brett(8,1)
       Table(8,2)=10;
       Table(7,1:2)=10; 
   end
   
   if Brett(8,8)
       Table(8,7)=10;
       Table(7,7:8)=10; 
   end
Faktor = [0.1 4 3 10 3];

Zeros = sum(~Brett(:));
FaktorTemp = exp(-Faktor(5)*Zeros);

Bewertung = ...
    FaktorTemp * Farbe * sum(Brett(:)) ...
    ...
    + (1-FaktorTemp)*(...
    Faktor(1) * Farbe * sum( Table(:).*Brett(:) ) ...
    ...
    + Faktor(2) * Faktor(3) * sum(sum(conv2([1; 1; 1], [1; 1; 1], double(Brett == -Farbe), 'same') .* ~Brett))/(64-Zeros)...
    ...
    - Faktor(2) * sum(sum(conv2([1; 1; 1], [1; 1; 1], double(Brett == Farbe), 'same') .* ~Brett))/(64-Zeros)...
    ...
    + Faktor(4) * (mod(Zeros, 2)-0.5) ...
    );
    
end